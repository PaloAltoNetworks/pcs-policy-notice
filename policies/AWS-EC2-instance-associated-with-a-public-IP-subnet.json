{
  "policyUpi": "PC-AWS-EC2-355",
  "policyId": "0e44dabe-a8b9-401b-936b-bb8a0a80279a",
  "policyType": "config",
  "cloudType": "aws",
  "severity": "medium",
  "name": "AWS EC2 instance associated with a public IP subnet",
  "description": "This policy identifies the EC2 instances which are associated with a public IP subnet. Using public IP subnet automatically or on launch can accidentally expose the instances within this subnet to the internet. It is a best practice to ensure that there are no EC2 instances with public IP subnet which have internet access.",
  "rule.criteria": "9ff9aa37-e2c1-4ec9-88b0-7e1dc99799ce",
  "searchModel.query": "config from cloud.resource where api.name = 'aws-ec2-describe-instances' AND json.rule = state.code equals 16 as X; config from cloud.resource where api.name = 'aws-ec2-describe-subnets' AND json.rule = mapPublicIpOnLaunch is true as Y; filter '$.X.subnetId equals $.Y.subnetId'; show X;",
  "recommendation": "Follow below mention URL:\nhttps://aws.amazon.com/premiumsupport/knowledge-center/move-ec2-instance/",
  "remediable": false,
  "remediation.cliScriptTemplate": "",
  "remediation.description": "",
  "remediation.impact": "",
  "compliance.standard": [
    "APRA (CPS 234) Information Security",
    "Brazilian Data Protection Law (LGPD)",
    "CCPA 2018",
    "CSA CCM v.4.0.1",
    "Cybersecurity Maturity Model Certification (CMMC) v.1.02",
    "HITRUST v.9.4.2",
    "MITRE ATT&CK v6.3",
    "MITRE ATT&CK v8.2",
    "Multi-Level Protection Scheme (MLPS) v2.0",
    "NIST 800-53 Rev 5",
    "NIST 800-53 Rev4",
    "NIST CSF",
    "NIST SP 800-171 Revision 2",
    "NIST SP 800-172",
    "PCI DSS v3.2.1",
    "PIPEDA"
  ]
}