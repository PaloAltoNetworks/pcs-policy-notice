{
  "policyUpi": "PC-AZR-APP-410",
  "policyId": "4f5c4a28-c3df-4bee-a980-621c794548ed",
  "policyType": "config",
  "cloudType": "azure",
  "severity": "medium",
  "name": "Azure App Service Web app doesn't use HTTP 2.0",
  "description": "HTTP 2.0 has additional performance improvements on the head-of-line blocking problem of old HTTP version, header compression, and prioritization of requests. HTTP 2.0 no longer supports HTTP 1.1's chunked transfer encoding mechanism, as it provides its own, more efficient, mechanisms for data streaming.",
  "rule.criteria": "54957a87-ae1f-4776-a656-7a274498b153",
  "searchModel.query": "config from cloud.resource where cloud.type = 'azure' AND api.name = 'azure-app-service' AND json.rule = 'kind starts with app and config.http20Enabled equals false'",
  "recommendation": "1. Log in to the Azure portal\n2. Navigate to App Services\n3. Click on the reported App\n4. Under Setting section, Click on 'Configuration'\n5. Under 'General Settings' tab, In 'Platform settings', Set 'HTTP version' to '2.0'",
  "remediable": true,
  "remediation.cliScriptTemplate": "az webapp config set --resource-group ${resourceGroup} --name ${resourceName} --http20-enabled true",
  "remediation.description": "This CLI command requires 'Microsoft.Web/sites/{app_name}/config/*' permission. Successful execution sets HTTP version to 2.0, which has additional performance improvements on the head-of-line blocking problem of old HTTP version, header compression, and prioritization of requests.",
  "remediation.impact": "Sets latest HTTP version in Azure App Service",
  "compliance.standard": [
    "APRA (CPS 234) Information Security",
    "Brazilian Data Protection Law (LGPD)",
    "CIS v1.1 (Azure)",
    "CIS v1.2.0 (Azure)",
    "CIS v1.3.0 (Azure)",
    "CSA CCM v.4.0.1",
    "Cybersecurity Maturity Model Certification (CMMC) v.1.02",
    "HITRUST v.9.4.2",
    "NIST 800-53 Rev 5",
    "NIST 800-53 Rev4",
    "NIST CSF",
    "NIST SP 800-171 Revision 2",
    "NIST SP 800-172",
    "PCI DSS v3.2.1"
  ]
}