{
  "policyUpi": "PC-AZR-SQL-107",
  "policyId": "0faffeb6-dbcd-4715-be6e-f9cadc64cfeb",
  "policyType": "config",
  "cloudType": "azure",
  "severity": "medium",
  "name": "SQL Server Firewall rules allow access to any Azure internal resources",
  "description": "Firewalls grant access to databases based on the originating IP address of each request and should be within the range of START IP and END IP. Firewall settings with START IP and END IP both with \"0.0.0.0\" represents access to all Azure internal network. This setting needs to be turned-off to remove blanket access.",
  "rule.criteria": "7f47b618-4e96-459e-bfe3-9e6f48fec533",
  "searchModel.query": "config from cloud.resource where api.name = 'azure-sql-server-list' AND json.rule = \"$.firewallRules.[*] size > 0 and $.firewallRules.[*].endIpAddress contains 0.0.0.0 and $.firewallRules.[*].startIpAddress contains 0.0.0.0\"",
  "recommendation": "1.Login to Azure Portal\n2.Click on 'All services' on left Navigation\n3.Click on 'SQL servers' under DATABASES\n4.Click on reported server instance\n5.Click on 'Firewalls and virtual networks' under SETTINGS\n6.Set the value of 'Allow access to Azure services' to OFF\n7.Click on Save",
  "remediable": false,
  "remediation.cliScriptTemplate": "",
  "remediation.description": "",
  "remediation.impact": "",
  "compliance.standard": [
    "APRA (CPS 234) Information Security",
    "Brazilian Data Protection Law (LGPD)",
    "CCPA 2018",
    "CIS v1.1 (Azure)",
    "CIS v1.2.0 (Azure)",
    "CIS v1.3.0 (Azure)",
    "CSA CCM v.4.0.1",
    "CSA CCM v3.0.1",
    "Cybersecurity Maturity Model Certification (CMMC) v.1.02",
    "HITRUST CSF v9.3",
    "ISO 27001:2013",
    "MITRE ATT&CK v6.3",
    "MITRE ATT&CK v8.2",
    "Multi-Level Protection Scheme (MLPS) v2.0",
    "NIST 800-53 Rev4",
    "NIST CSF",
    "NIST SP 800-171 Revision 2",
    "NIST SP 800-172",
    "PCI DSS v3.2.1",
    "PIPEDA",
    "SOC 2"
  ]
}